{
  "hash": "7003d88668821b697745c146305bcb23",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"VID : Analyse exploratoire des données\"\nsubtitle: \"De la théorie à la pratique (TP 1)\"\nauthor:\n  - name: Rémi Ançay & Lucas Charbonnier\nhighlight-style: github\nformat:\n  html:\n    theme: cosmo\n    monobackgroundcolor: rgb(255,250,240)\n    toc: true\n    toc-location: left\n    #reference-location: margin\n    reference-location: document\n    code-line-numbers: true\ndate: 'last-modified'\ndate-format: '[This version:] MMMM D, YYYY'\nnumber-sections: false\neditor: \n  visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"readxl\")\n#install.packages(\"HSAUR2\")\nlibrary(\"readxl\")\nlibrary(\"HSAUR2\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLe chargement a nécessité le package : tools\n```\n\n\n:::\n:::\n\n\n## Introduction\n\nDans ce premier TP, nous allons prendre en main R ainsi que RStudio et Quarto. Pour se faire, nous allons jouer avec plusieurs jeux de données qui nous servirons de base pour faire de l'analyse.\n\n# Exercice 1\n\n**a.** Les données figurent dans le fichier Notes.xlsx qui se trouve dans la page Moodle du cours. Télécharger le fichier et enregistrer les données dans l’objet examen de R en utilisant la librairie readxl.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexamen <- read_excel(\"files/Notes.xlsx\")\nexamen\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 82 × 2\n   Classe  Note\n   <chr>  <dbl>\n 1 A        5.7\n 2 A        4.1\n 3 A        5.9\n 4 A        3.6\n 5 A        3  \n 6 A        4.4\n 7 A        2.5\n 8 A       NA  \n 9 A        5.3\n10 A        3  \n# ℹ 72 more rows\n```\n\n\n:::\n:::\n\n\n**b.** Reconstituer les boîtes à moustaches en parallèle figurant ci-dessous.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(examen$Note, horizontal = TRUE)\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nCalculer les écarts-types des trois classes à l’aide des fonctions by() et sd().\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lattice)\ndata(Titanic)\nTitanic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n, , Age = Child, Survived = No\n\n      Sex\nClass  Male Female\n  1st     0      0\n  2nd     0      0\n  3rd    35     17\n  Crew    0      0\n\n, , Age = Adult, Survived = No\n\n      Sex\nClass  Male Female\n  1st   118      4\n  2nd   154     13\n  3rd   387     89\n  Crew  670      3\n\n, , Age = Child, Survived = Yes\n\n      Sex\nClass  Male Female\n  1st     5      1\n  2nd    11     13\n  3rd    13     14\n  Crew    0      0\n\n, , Age = Adult, Survived = Yes\n\n      Sex\nClass  Male Female\n  1st    57    140\n  2nd    14     80\n  3rd    75     76\n  Crew  192     20\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntitanic.bar<-barchart(Class~Freq|Sex + Age, data=as.data.frame(Titanic), \n                      groups=Survived, stack=TRUE, layout=c(4,1), \n                      auto.key=list(title=\"Survived\", columns=2))\nprint(titanic.bar)\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"plasma\")\n\nplasma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   fibrinogen globulin      ESR\n1        2.52       38 ESR < 20\n2        2.56       31 ESR < 20\n3        2.19       33 ESR < 20\n4        2.18       31 ESR < 20\n5        3.41       37 ESR < 20\n6        2.46       36 ESR < 20\n7        3.22       38 ESR < 20\n8        2.21       37 ESR < 20\n9        3.15       39 ESR < 20\n10       2.60       41 ESR < 20\n11       2.29       36 ESR < 20\n12       2.35       29 ESR < 20\n16       3.15       36 ESR < 20\n18       2.68       34 ESR < 20\n19       2.60       38 ESR < 20\n20       2.23       37 ESR < 20\n21       2.88       30 ESR < 20\n22       2.65       46 ESR < 20\n24       2.28       36 ESR < 20\n25       2.67       39 ESR < 20\n26       2.29       31 ESR < 20\n27       2.15       31 ESR < 20\n28       2.54       28 ESR < 20\n30       3.34       30 ESR < 20\n31       2.99       36 ESR < 20\n32       3.32       35 ESR < 20\n13       5.06       37 ESR > 20\n14       3.34       32 ESR > 20\n15       2.38       37 ESR > 20\n17       3.53       46 ESR > 20\n23       2.09       44 ESR > 20\n29       3.93       32 ESR > 20\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(plasma[\"fibrinogen\"], plasma[\"globulin\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             globulin\nfibrinogen 0.08071681\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplasma.glm<-glm(ESR~fibrinogen+globulin, data=plasma, family=binomial)\nprob<-predict(plasma.glm, type=\"response\")\npar(pty=\"s\")\nplot(globulin~fibrinogen, data=plasma, xlim=c(2,6), ylim=c(25,55), pch=20, \n     xlab=\"fibrinogène\", ylab=\"globuline\", main=\"\")\nsymbols(plasma$fibrinogen, plasma$globulin, circles=prob, add=TRUE, fg=\"red\", \n        bg=\"orange\")\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# Suite Exo4a\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanscombe.1<-data.frame(x1=anscombe$x1, x4=anscombe$x4, y1=anscombe$y1, \n                       y2=anscombe$y2, y3=anscombe$y3, y4=anscombe$y4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"corrplot\")\nlibrary(\"corrplot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.92 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\ncorMatrix <- cor(anscombe.1)\ncorrplot.mixed(corMatrix)\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"corrr\")\n\nlibrary(corrr)\n\ncorrelation_matrix <- correlate(anscombe.1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCorrelation computed with\n• Method: 'pearson'\n• Missing treated using: 'pairwise.complete.obs'\n```\n\n\n:::\n\n```{.r .cell-code}\nnetwork_plot(correlation_matrix)\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"GGally\")\n\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLe chargement a nécessité le package : ggplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggpairs(anscombe.1)\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggpairs(anscombe.1, columns = c(\"x1\", \"y1\"))\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggpairs(anscombe.1, columns = c(\"x1\", \"y2\"))\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggpairs(anscombe.1, columns = c(\"x1\", \"y3\"))\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n```{.r .cell-code}\nggpairs(anscombe.1, columns = c(\"x4\", \"y4\"))\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n:::\n\n\n# Exo 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"skimr\")\nlibrary(\"skimr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttachement du package : 'skimr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nL'objet suivant est masqué depuis 'package:corrr':\n\n    focus\n```\n\n\n:::\n\n```{.r .cell-code}\n#install.packages(\"palmerpenguins\")\nlibrary(\"palmerpenguins\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n**b.** Quelle variable possède le plus de valeurs manquantes ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(penguins)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |         |\n|:------------------------|:--------|\n|Name                     |penguins |\n|Number of rows           |344      |\n|Number of columns        |8        |\n|_______________________  |         |\n|Column type frequency:   |         |\n|factor                   |3        |\n|numeric                  |5        |\n|________________________ |         |\n|Group variables          |None     |\n\n\n**Variable type: factor**\n\n|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                  |\n|:-------------|---------:|-------------:|:-------|--------:|:---------------------------|\n|species       |         0|          1.00|FALSE   |        3|Ade: 152, Gen: 124, Chi: 68 |\n|island        |         0|          1.00|FALSE   |        3|Bis: 168, Dre: 124, Tor: 52 |\n|sex           |        11|          0.97|FALSE   |        2|mal: 168, fem: 165          |\n\n\n**Variable type: numeric**\n\n|skim_variable     | n_missing| complete_rate|    mean|     sd|     p0|     p25|     p50|    p75|   p100|hist  |\n|:-----------------|---------:|-------------:|-------:|------:|------:|-------:|-------:|------:|------:|:-----|\n|bill_length_mm    |         2|          0.99|   43.92|   5.46|   32.1|   39.23|   44.45|   48.5|   59.6|▃▇▇▆▁ |\n|bill_depth_mm     |         2|          0.99|   17.15|   1.97|   13.1|   15.60|   17.30|   18.7|   21.5|▅▅▇▇▂ |\n|flipper_length_mm |         2|          0.99|  200.92|  14.06|  172.0|  190.00|  197.00|  213.0|  231.0|▂▇▃▅▂ |\n|body_mass_g       |         2|          0.99| 4201.75| 801.95| 2700.0| 3550.00| 4050.00| 4750.0| 6300.0|▃▇▆▃▂ |\n|year              |         0|          1.00| 2008.03|   0.82| 2007.0| 2007.00| 2008.00| 2009.0| 2009.0|▇▁▇▁▇ |\n\n\n:::\n:::\n\n\nC'est la colonne \"sex\" avec 11 valeurs manquantes\n\n**c.** Quelle espèce est la plus représentée ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(penguins$species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   Adelie Chinstrap    Gentoo \n      152        68       124 \n```\n\n\n:::\n:::\n\n\n**d.** Nous nous proposons de tracer des graphiques de nuages de points à l’aide de la librairie `ggplot2` qu’il faut d’abord installer si nécessaire puis activer dans votre session.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, aes(x = flipper_length_mm, y = bill_length_mm)) +\n  geom_point(aes(color = species, shape = species), size = 3, alpha = 0.8) +\n  scale_color_manual(values = c(\"darkorange\",\"purple\",\"cyan4\")) +\n  labs(title = \"Taille des manchots, Palmer Station LTER\",\n       subtitle = \"Longueur des nageoires et longueur du bec chez les manchots Adelie, Chinstrap et de Gentoo\",\n       x = \"Longueur des nageoire (mm)\",\n       y = \"Longueur du bec (mm)\",\n       color = \"Espèce de manchots\",\n       shape = \"Espèce de manchots\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nExiste-t-il une relation entre la longueur du bec et la longueur des nageoires ? Dans l’affirmative, de quelle nature est-elle ?\n\n-   Oui il y a une correlation. plus la longueur des nagoire est grande, plus celle du bec l'est aussi\n\n**e.** Remarque-t-on des observations inhabituelles dans le graphique de nuage de points ?\n\n-   Oui, on peut noté le spécimen \"Chinstrap\" avec une longueur de nagoire à 180mm et une longueur de bec a 58mm\n\n**f.** Quelle valeur attribueriez-vous à la longueur des nageoires pour distinguer les manchots de Gentoo des deux autres espèces ?\n\n-   les Gentoo ont des nagoires d'une taille supérieur à 205mm\n\n**g.** Déterminer la corrélation entre la longueur du bec et la longueur des nageoires.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(penguins$bill_length_mm, penguins$flipper_length_mm, use = \"complete.obs\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6561813\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, aes(x = flipper_length_mm, y = bill_length_mm)) +\n  geom_point(aes(color = species, shape = island), size = 3, alpha = 0.8) +\n  scale_color_manual(values = c(\"darkorange\",\"purple\",\"cyan4\")) +\n  labs(title = \"Taille des manchots, Palmer Station LTER\",\n       subtitle = \"Longueur des nageoires et longueur du bec chez les manchots Adelie, Chinstrap et de Gentoo\",\n       x = \"Longueur des nageoire (mm)\",\n       y = \"Longueur du bec (mm)\",\n       color = \"Espèce de manchots\",\n       shape = \"Espèce de manchots\") +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nSur quelle île vivent exclusivement les manchots de Gentoo ?\n\n**i.** Pour répondre à cette question, on peut également construire le graphique de points tracé ci-dessous.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins, aes(x = island, y = species, color = species)) +\n  geom_jitter(size = 3) + \n  scale_color_manual(values = c(\"darkorange\",\"purple\",\"cyan4\")) +\n  labs(x = \"Iles\",\n       y = \"Espèce de manchots\",\n       color = \"Espèce de manchots\")\n```\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nLes Gentoo vivent tous sur l'ile Biscoe\n\n**j.** Tracer le nuage de points de la longueur du bec (*bill length*) versus la longueur des nageoires (*flipper length*) selon l’espèce et le sexe des manchots en utilisant le composant `facet_wrap()` de la fonction `ggplot()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tracer le nuage de points de la longueur du bec versus la longueur des nageoires selon l'espèce et le sexe des manchots\nggplot(penguins, aes(x = bill_length_mm, y = flipper_length_mm, color = sex)) +\n  geom_point() +\n  labs(x = \"Longueur du bec (mm)\", y = \"Longueur des nageoires (mm)\") +\n  facet_wrap(~ species, scales = \"free\") +\n  ggtitle(\"Nuage de points : Longueur du bec vs Longueur des nageoires selon l'espèce et le sexe\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](TP1_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n# Exo 6\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"readr\")\nlibrary(\"readr\")\n\n#install.packages(\"treemapify\")\nlibrary(\"treemapify\")\n\n#install.packages(\"camcorder\")\nlibrary(\"camcorder\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nisc_grant <- read_csv(\"files/isc_grants.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 85 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): title, proposed_by, summary, website\ndbl (3): year, group, funded\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(isc_grant)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |isc_grant |\n|Number of rows           |85        |\n|Number of columns        |7         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |4         |\n|numeric                  |3         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min|  max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|----:|-----:|--------:|----------:|\n|title         |         0|          1.00|   4|  120|     0|       85|          0|\n|proposed_by   |         0|          1.00|   8|   63|     0|       66|          0|\n|summary       |         0|          1.00|  31| 2210|     0|       85|          0|\n|website       |        33|          0.61|  21|  224|     0|       48|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|     mean|       sd|   p0|  p25|   p50|   p75|  p100|hist  |\n|:-------------|---------:|-------------:|--------:|--------:|----:|----:|-----:|-----:|-----:|:-----|\n|year          |         0|             1|  2019.14|     2.08| 2016| 2017|  2019|  2021|  2023|▇▆▇▅▅ |\n|group         |         0|             1|     1.40|     0.49|    1|    1|     1|     2|     2|▇▁▁▁▅ |\n|funded        |         0|             1| 13781.14| 11325.80|    0| 6000| 10000| 16000| 62400|▇▂▁▁▁ |\n\n\n:::\n:::\n\n\n**b.** Nous allons construire une carte à cases (*treemap*) des candidatures à l’obtention d’une bourse du Consortium en utilisant la librairie `treemapify` de ***R***.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_record(dir=\"ISCgrant\", device=\"png\", width=9, height=8, units=\"in\", dpi=320)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in gg_record(dir = \"ISCgrant\", device = \"png\", width = 9, height = 8, :\nWriting to a folder that already exists. gg_playback may use more files than\nintended!\n```\n\n\n:::\n\n```{.r .cell-code}\npal<-c(\"#002870\",\"#005A87\",\"#078788\",\"#A5A63C\",\"#DE9704\",\"#C45D27\",\"#AD3518\",\"#990C00\")\n```\n:::\n\n\nTracer la carte à cases ci-dessous en complétant les commandes données au-dessous du graphique.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(isc_grant, aes(area=funded, fill=factor(year), subgroup=year)) +\n  geom_treemap(radius=unit(0.2, \"line\"), color=\"white\", size=2) +\n  geom_treemap_text(aes(label=paste0(title, \"\\n\", proposed_by, \"\\n\\n\", scales::dollar(funded))), reflow=TRUE, grow=TRUE, color=\"white\") +\n  geom_treemap_subgroup_text(aes(label=year), color=\"white\", grow=TRUE, alpha=0.25) +\n  scale_fill_manual(values=pal) +\n  labs(\n    title=\"Bourses accordées selon les années\",\n    caption=\"Source: Comité de pilotage du consortium R\",\n    fill=\"year\") +\n  theme_void()+\n  theme(\n    legend.position=\"none\",\n    plot.background=element_rect(fill=\"grey99\", color=NA),\n    plot.title=element_text(size=30, face=\"bold\", color=\"#0D2765\", margin=margin(0, 0, 5, 0)),\n    plot.caption=element_text(color=\"#0D2765\"),\n    plot.margin=margin(10, 10, 10, 10)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in geom_treemap_subgroup_text(aes(label = year), color = \"white\", :\nIgnoring unknown aesthetics: label\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}