<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rémi Ançay &amp; Lucas Charbonnier">

<title>VID</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TP2_files/libs/clipboard/clipboard.min.js"></script>
<script src="TP2_files/libs/quarto-html/quarto.js"></script>
<script src="TP2_files/libs/quarto-html/popper.min.js"></script>
<script src="TP2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TP2_files/libs/quarto-html/anchor.min.js"></script>
<link href="TP2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TP2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TP2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TP2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TP2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#gestion-des-librairies" id="toc-gestion-des-librairies" class="nav-link" data-scroll-target="#gestion-des-librairies">Gestion des librairies</a></li>
  </ul></li>
  <li><a href="#exercice-1" id="toc-exercice-1" class="nav-link" data-scroll-target="#exercice-1">Exercice 1</a>
  <ul class="collapse">
  <li><a href="#chargement-des-données" id="toc-chargement-des-données" class="nav-link" data-scroll-target="#chargement-des-données">Chargement des données</a></li>
  <li><a href="#coefficient-de-correlation" id="toc-coefficient-de-correlation" class="nav-link" data-scroll-target="#coefficient-de-correlation">Coefficient de correlation</a></li>
  <li><a href="#nuage-de-points" id="toc-nuage-de-points" class="nav-link" data-scroll-target="#nuage-de-points">Nuage de points</a></li>
  <li><a href="#régression-linéaire" id="toc-régression-linéaire" class="nav-link" data-scroll-target="#régression-linéaire">Régression linéaire</a></li>
  <li><a href="#ajustement-du-graphique" id="toc-ajustement-du-graphique" class="nav-link" data-scroll-target="#ajustement-du-graphique">Ajustement du graphique</a></li>
  <li><a href="#variance-des-résidus-et-coefficient-r2" id="toc-variance-des-résidus-et-coefficient-r2" class="nav-link" data-scroll-target="#variance-des-résidus-et-coefficient-r2">Variance des résidus et coefficient <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#diagnostic-du-modèle" id="toc-diagnostic-du-modèle" class="nav-link" data-scroll-target="#diagnostic-du-modèle">Diagnostic du modèle</a></li>
  <li><a href="#évaluation-de-lajustement-du-modèle" id="toc-évaluation-de-lajustement-du-modèle" class="nav-link" data-scroll-target="#évaluation-de-lajustement-du-modèle">Évaluation de l’ajustement du modèle</a></li>
  <li><a href="#test-avec-un-niveau-de-signification-5" id="toc-test-avec-un-niveau-de-signification-5" class="nav-link" data-scroll-target="#test-avec-un-niveau-de-signification-5">Test avec un niveau de signification 5%</a></li>
  </ul></li>
  <li><a href="#exercice-2" id="toc-exercice-2" class="nav-link" data-scroll-target="#exercice-2">Exercice 2</a>
  <ul class="collapse">
  <li><a href="#chargement-des-données-1" id="toc-chargement-des-données-1" class="nav-link" data-scroll-target="#chargement-des-données-1">Chargement des données</a></li>
  <li><a href="#résumé" id="toc-résumé" class="nav-link" data-scroll-target="#résumé">Résumé</a></li>
  <li><a href="#grapgique-de-nuage-de-points" id="toc-grapgique-de-nuage-de-points" class="nav-link" data-scroll-target="#grapgique-de-nuage-de-points">Grapgique de nuage de points</a></li>
  <li><a href="#droite-de-régression-linaire" id="toc-droite-de-régression-linaire" class="nav-link" data-scroll-target="#droite-de-régression-linaire">Droite de régression linaire</a></li>
  <li><a href="#coefficient-r-et-r2" id="toc-coefficient-r-et-r2" class="nav-link" data-scroll-target="#coefficient-r-et-r2">Coefficient <span class="math inline">\(r\)</span> et <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#vérification-des-hypothèses" id="toc-vérification-des-hypothèses" class="nav-link" data-scroll-target="#vérification-des-hypothèses">Vérification des hypothèses</a></li>
  <li><a href="#prédiction" id="toc-prédiction" class="nav-link" data-scroll-target="#prédiction">Prédiction</a></li>
  <li><a href="#analyse-supplémentaire" id="toc-analyse-supplémentaire" class="nav-link" data-scroll-target="#analyse-supplémentaire">Analyse supplémentaire</a></li>
  </ul></li>
  <li><a href="#exercice-3" id="toc-exercice-3" class="nav-link" data-scroll-target="#exercice-3">Exercice 3</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VID</h1>
<p class="subtitle lead">Modèles de régression linéaires (TP 2)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rémi Ançay &amp; Lucas Charbonnier </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">This version: May 6, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Dans ce deuxième TP, nous allons nous préciser sur les modèles de régression linéaire. Pour se faire, nous allons étudier plusieurs jeux de données et resortir leurs caractéristiques.</p>
<section id="gestion-des-librairies" class="level3">
<h3 class="anchored" data-anchor-id="gestion-des-librairies">Gestion des librairies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>r <span class="ot">=</span> <span class="fu">getOption</span>(<span class="st">"repos"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>r[<span class="st">"CRAN"</span>] <span class="ot">=</span> <span class="st">"http://cran.us.r-project.org"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">options</span>(<span class="at">repos =</span> r)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">install.packages</span>(<span class="st">"ggResidpanel"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(<span class="st">"ggResidpanel"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">install.packages</span>(<span class="st">"ggrepel"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(<span class="st">"ggrepel"</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">install.packages</span>(<span class="st">"GGally"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(<span class="st">"GGally"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercice-1" class="level2">
<h2 class="anchored" data-anchor-id="exercice-1">Exercice 1</h2>
<section id="chargement-des-données" class="level3">
<h3 class="anchored" data-anchor-id="chargement-des-données">Chargement des données</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>kalama <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/kalama.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="coefficient-de-correlation" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-de-correlation">Coefficient de correlation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Coefficient de corelation entre la taille et l'âge (0.994)</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">cor</span>(kalama)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             age    taille
age    1.0000000 0.9943661
taille 0.9943661 1.0000000</code></pre>
</div>
</div>
</section>
<section id="nuage-de-points" class="level3">
<h3 class="anchored" data-anchor-id="nuage-de-points">Nuage de points</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Nuage de points du dataset</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">plot</span>(kalama)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="régression-linéaire" class="level3">
<h3 class="anchored" data-anchor-id="régression-linéaire">Régression linéaire</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Regression linéaire</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>kalama.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(taille<span class="sc">~</span>age, <span class="at">data=</span>kalama)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">summary</span>(kalama.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = taille ~ age, data = kalama)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27238 -0.24248 -0.02762  0.16014  0.47238 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.9283     0.5084  127.71  &lt; 2e-16 ***
age           0.6350     0.0214   29.66 4.43e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.256 on 10 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.9876 
F-statistic:   880 on 1 and 10 DF,  p-value: 4.428e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">coef</span>(kalama.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         age 
  64.928322    0.634965 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Pente (beta 0) : 0.635</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Ordonnée à l'origine (beta 1) : 64.9283</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ajustement-du-graphique" class="level3">
<h3 class="anchored" data-anchor-id="ajustement-du-graphique">Ajustement du graphique</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">plot</span>(kalama)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">abline</span>(kalama.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="variance-des-résidus-et-coefficient-r2" class="level3">
<h3 class="anchored" data-anchor-id="variance-des-résidus-et-coefficient-r2">Variance des résidus et coefficient <span class="math inline">\(R^2\)</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># On peut obtenir la variance des résidus avec la fonction deviance() -&gt; 0.655</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">deviance</span>(kalama.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6551748</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Le coefficient de détermination R^2 est égal au carré du coefficient de correlation et est affiché dans le summary() de la régression.</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># R^2 = 0.9888</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnostic-du-modèle" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-du-modèle">Diagnostic du modèle</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">resid_panel</span>(kalama.lm, <span class="at">plots=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Grâce au Q-Q Plot et à la Cook’s Distance, on peut voir qu’il y a deux valeurs en début de série qui sorte du lot. Le reste des valeurs suivent une corrélation assez nette.</p>
</section>
<section id="évaluation-de-lajustement-du-modèle" class="level3">
<h3 class="anchored" data-anchor-id="évaluation-de-lajustement-du-modèle">Évaluation de l’ajustement du modèle</h3>
<p>La droite de régression est très pertinente et décrit bien la corrélation entre les données. De plus, le coefficient de détermination <span class="math inline">\(R^2\)</span> est très proche de 1 (0.9888) donc on peut dire que le modèle est bien ajusté.</p>
</section>
<section id="test-avec-un-niveau-de-signification-5" class="level3">
<h3 class="anchored" data-anchor-id="test-avec-un-niveau-de-signification-5">Test avec un niveau de signification 5%</h3>
<p>On peut extraire le niveau de signification du summary de la manière suivante :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>significance_level <span class="ot">=</span> <span class="fu">summary</span>(kalama.lm)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>]</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">print</span>(significance_level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.428071e-11</code></pre>
</div>
</div>
<p>Comme on peut le voir, ce niveau est bien inférieur à 0.05 donc on peut dire que la pente de la droite de régression est significativement différente de 0.</p>
</section>
</section>
<section id="exercice-2" class="level2">
<h2 class="anchored" data-anchor-id="exercice-2">Exercice 2</h2>
<section id="chargement-des-données-1" class="level3">
<h3 class="anchored" data-anchor-id="chargement-des-données-1">Chargement des données</h3>
<p>Nous avons créé un fichier <code>pnb_mortalite.txt</code> dans lequel nous avons copié-collé le contenu des données à importer. Cela nous a paru plus simple que de tout réécrire à la main dans une commande.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>pnb_data <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"data/pnb_mortalite.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>pnb_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            pays PNB mortalite
1  Allemagne-RFA 190        24
2       Autriche 128        28
3       Belgique 180        24
4       Danemark 212        19
5        Espagne  56        37
6         France 192        22
7          Grèce  68        34
8        Irlande  98        25
9         Italie 110        36
10    Luxembourg 197        24
11      Pays-Bas 155        14
12      Portugal  40        65
13   Royaume-Uni 181        20
14        Suisse 233        18</code></pre>
</div>
</div>
</section>
<section id="résumé" class="level3">
<h3 class="anchored" data-anchor-id="résumé">Résumé</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">summary</span>(pnb_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     pays                PNB          mortalite    
 Length:14          Min.   : 40.0   Min.   :14.00  
 Class :character   1st Qu.:101.0   1st Qu.:20.50  
 Mode  :character   Median :167.5   Median :24.00  
                    Mean   :145.7   Mean   :27.86  
                    3rd Qu.:191.5   3rd Qu.:32.50  
                    Max.   :233.0   Max.   :65.00  </code></pre>
</div>
</div>
</section>
<section id="grapgique-de-nuage-de-points" class="level3">
<h3 class="anchored" data-anchor-id="grapgique-de-nuage-de-points">Grapgique de nuage de points</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(pnb_data, <span class="fu">aes</span>(<span class="at">x =</span> PNB, <span class="at">y =</span> mortalite)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># Ajouter la droite de régression linéaire</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> pays), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">box.padding =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># Ajouter les noms des pays avec ggrepel</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Produit national brut"</span>, <span class="at">y =</span> <span class="st">"Mortalité infantile"</span>, <span class="at">title =</span> <span class="st">"Nuage de points : Mortalité infantile en fonction du PNB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Comme on peut le voir sur le nuage de points ci-dessus, la plupart des pays suive la tendance sauf le Portugal qui sort très clairement du lot.</p>
</section>
<section id="droite-de-régression-linaire" class="level3">
<h3 class="anchored" data-anchor-id="droite-de-régression-linaire">Droite de régression linaire</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>pnb_data.lm <span class="ot">=</span> <span class="fu">lm</span>(mortalite<span class="sc">~</span>PNB, <span class="at">data=</span>pnb_data)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">coef</span>(pnb_data.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         PNB 
 51.0132698  -0.1589146 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">summary</span>(pnb_data.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mortalite ~ PNB, data = pnb_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.382  -4.504   1.545   3.002  20.343 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 51.01327    5.77263   8.837 1.34e-06 ***
PNB         -0.15891    0.03663  -4.338 0.000965 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.223 on 12 degrees of freedom
Multiple R-squared:  0.6106,    Adjusted R-squared:  0.5782 
F-statistic: 18.82 on 1 and 12 DF,  p-value: 0.000965</code></pre>
</div>
</div>
<p>La pente est de <strong>-0.16</strong> et l’ordonnée à l’origine est de <strong>51</strong>.</p>
</section>
<section id="coefficient-r-et-r2" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-r-et-r2">Coefficient <span class="math inline">\(r\)</span> et <span class="math inline">\(R^2\)</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">cor</span>(pnb_data<span class="sc">$</span>PNB, pnb_data<span class="sc">$</span>mortalite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7814228</code></pre>
</div>
</div>
<p>Le coefficient de corrélation <code>r</code> est de : <strong>-0.78</strong>.</p>
<p>Le coefficient de <em>détermination</em>, indiqué dans le summary() ci-dessus, vaut 0.6106 et correspond effectivement au carré du coefficient de corrélation.</p>
</section>
<section id="vérification-des-hypothèses" class="level3">
<h3 class="anchored" data-anchor-id="vérification-des-hypothèses">Vérification des hypothèses</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">resid_panel</span>(pnb_data.lm, <span class="at">plots=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>L’hypothèse que nous avions faite, soit que le Portugal est atypique, est confirmée par les graphiques ci-dessus. Que ce soit dans le Q-Q plot, le boxplot ou la distance de Cook, on voit qu’il y a une valeur atypique.</p>
</section>
<section id="prédiction" class="level3">
<h3 class="anchored" data-anchor-id="prédiction">Prédiction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>xnew <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">100</span>), <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">colnames</span>(xnew) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PNB"</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a>xnew <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(xnew)</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="fu">predict</span>(pnb_data.lm, xnew, <span class="at">interval=</span><span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 35.12181 16.22173 54.02189</code></pre>
</div>
</div>
<p>La prédiction est de 35.12, soit exactement sur la ligne de la régression linéaire.</p>
</section>
<section id="analyse-supplémentaire" class="level3">
<h3 class="anchored" data-anchor-id="analyse-supplémentaire">Analyse supplémentaire</h3>
<p>Ce nouveau modèle donne un meilleur coefficient de détermination (0.61 avec une régression linéaire, 0.78 avec un log).</p>
<p>Nous pensons qu’un modèle logarithmique serait effectivement mieux adapté à la prédiction de la mortalité infantile car un modèle linéaire implique qu’avec un certain PNB, le taux de mortalité infantile pourrait atteindre 0. En pratique, on pourra s’en approcher mais jamais atteindre le 0%.</p>
</section>
</section>
<section id="exercice-3" class="level2">
<h2 class="anchored" data-anchor-id="exercice-3">Exercice 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>litters <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"data/litters.rds"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">ggpairs</span>(litters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>